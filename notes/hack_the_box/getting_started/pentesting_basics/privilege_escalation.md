## PrivEsc Checklists
After the initial access we will enumerate to find potential vulnerabilities to exploit to gain higher privilege level.
**Resources**
- [HackTricks](https://book.hacktricks.wiki/en/index.html)
- [PayloadsAllTheThigs](https://github.com/swisskyrepo/PayloadsAllTheThings)
## Enumeration Scripts
We can run some scripts to automatically enumerate the server,  by running common commands
**Scripts**
- [LinEnum](https://github.com/rebootuser/LinEnum)
- [linuxprivchecker](https://github.com/sleventyeleven/linuxprivchecker)
- [Seatbelt](https://github.com/GhostPack/Seatbelt)
- [JAWS](https://github.com/411Hall/JAWS)
- [Privilege Escalation Awesome Scripts SUITE(PEASS)](https://github.com/peass-ng/PEASS-ng)
> Note: These scripts will run many commands known for identifying vulnerabilities and create a lot of "noise" that may trigger anti-virus software or security monitoring software that looks for these types of events. This may prevent the scripts from running or even trigger an alarm that the system has been compromised. In some instances, we may want to do a manual enumeration instead of running scripts.
## Kernel Exploits
In enumeration when we find a server running an old operating system we must start looking for potential kernel vulnerabilities
## Vulnerable Software
Look for public exploits for any installed software if any older versions are in use
**Commands**:
- `dpkg -l`
- look in `C:\Program Files`
## User Privileges
Look for the privileges of the current user
**Common ways**:
- Sudo
	- Checking SUDO privileges with `sudo -l`
	- `NOPASSWD` tell us we could execute specific commands with out giving the password (we can specify the user with `-u`)
- SUID
- Windows Token Privileges
Once we have an application that could be executed with privileges, then we could check [GTFOBins](https://gtfobins.github.io/) [LOLBAS](https://lolbas-project.github.io/#)for searching a command that could be exploited through sudo.
## Scheduled Tasks
**Ways to use Scheduled Tasks*: 
1. Add new scheduled tasks/cron jobs
2. Trick them to execute a malicious software
**How to check if we are allowed to add a new schedule task**: 
- Linux:  if we have writing permissions on 
	1. `/etc/crontab`
	2. `/etc/cron.d`
	3. `/var/spool/cron/crontabs/root`
## Exposed Credentials
Looking around files searching for credentials
**Common places**
1. configuration files
2. logs
3. user history files
4. Password Reuse
## SSH Keys
Check in .ssh directory to read private keys, then if we can read /root/.ssh we can read `id_rsa` file, copying it and used with -i flag to log.
> Note that we used the command 'chmod 600 id_rsa' on the key after we created it on our machine to change the file's permissions to be more restrictive. If ssh keys have lax permissions, i.e., maybe read by other people, the ssh server would prevent them from working.

If we have write permissions on /.ssh/ directory we can place our public key in the target user at `/home/user/.ssh/authorized_keys`
**Generating a ssh-key**: `ssh-keygen -f key`
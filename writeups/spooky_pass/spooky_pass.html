<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="color-scheme" content="light dark">
<title>Ch1p's Blog</title>
<style>
	@media (prefers-color-scheme: dark){
		body {
			background:#000
		}
	}
	body{
		margin:1em auto;
		max-width:40em;
		padding:0 .62em 3.24em;
		font:1.2em/1.62 sans-serif
	}
	h1,h2,h3 {
		line-height:1.2
	}
	@media print{
		body{
			max-width:none
		}
	}
	img {
		display: block;
		margin: 1em auto;
	}
</style>
<article>
	<h1 id="spookypass">SpookyPass</h1>
<p>Created: August 3, 2025 10:02 PM Difficulty: Very Easy Category:
rev</p>
<p>This challenge gives us a binary that asks us for a password</p>
<figure>
<img src="../../images/spooky_pass/image_1.png" alt="image.png" />
</figure>
<p>So we know that this challenge consists on searching the password in
order to get access, first lets dive into <code>ida/ghidra</code> in
order to decompile the binary and understand the logic behind the
authentication.</p>
<pre class="c"><code>int __fastcall main(int argc, const char **argv, const char **envp)
{
  unsigned int i; // [rsp+4h] [rbp-BCh]
  char *v5; // [rsp+8h] [rbp-B8h]
  char v6[8]; // [rsp+10h] [rbp-B0h] BYREF
  _BYTE v7[10]; // [rsp+18h] [rbp-A8h] BYREF
  __int64 v8; // [rsp+22h] [rbp-9Eh]
  char s[136]; // [rsp+30h] [rbp-90h] BYREF
  unsigned __int64 v10; // [rsp+B8h] [rbp-8h]

  v10 = __readfsqword(0x28u);
  *(_QWORD *)v6 = 0;
  memset(v7, 0, sizeof(v7));
  v8 = 0;
  puts(&quot;Welcome to the \x1B[1;3mSPOOKIEST\x1B[0m party of the year.&quot;);
  printf(&quot;Before we let you in, you&#39;ll need to give us the password: &quot;);
  fgets(s, 128, _bss_start);
  v5 = strchr(s, 10);
  if ( v5 )
    *v5 = 0;
  if ( !strcmp(s, &quot;&lt;REDACTED&gt;&quot;) )
  {
    puts(&quot;Welcome inside!&quot;);
    for ( i = 0; i &lt;= 0x19; ++i )
      v6[i] = parts[i];
    puts(v6);
  }
  else
  {
    puts(&quot;You&#39;re not a real ghost; clear off!&quot;);
  }
  return 0;
} </code></pre>
<p><code>ida/ghidra</code> sent us to the entry function reading a
little bit of the code, we see that there is a conditional that depends
on the comparation between our input and the string
<code>&lt;REDACTED&gt;</code> which we could deduce is the asked
password. Letâ€™s put this in the binary and check the behavior.</p>
<figure>
<img src="../../images/spooky_pass/image_2.png" alt="image.png" width="640"/>
</figure>
<p>As we can see the flag is revealed.</p>
<h3 id="beyond-the-binary">Beyond the binary</h3>
<ol type="1">
<li>This challenge could be solved without using any de-compiler just
making <code>strings pass</code> and reading the context of the
un-obfuscated strings, we could be able of deduce the required
password.</li>
</ol>
<figure>
<img src="../../images/spooky_pass/image_3.png" alt="imahhe.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ol type="1">
<li>Another way to get the flag is by reading a little bit more the
decompiled code, specially on</li>
</ol>
<pre class="c"><code>for ( i = 0; i &lt;= 0x19; ++i )
      v6[i] = parts[i];
    puts(v6);</code></pre>
<p>Where in <code>v6</code> is being stored something and then printed,
with a bit of experience we could deduce that chars are being appended
to <code>v6</code> (clearly the chars of the flag), so we need to locate
where the variable <code>parts</code> is stored in the binary, here our
de-compiler is very useful because with just one click we are redirect
to the content</p>
<figure>
<img src="../../images/spooky_pass/image_4.png" alt="image.png" width="640"/>
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<p>here you just have to decode the content and get your flag.</p>
	<p><a href='/'>Home</a></p>
</article>
